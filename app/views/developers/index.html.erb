<% content_for :open_graph_tags do %>
  <%= render OpenGraphTagsComponent.new %>
<% end %>

<div class="max-w-5xl mx-auto">
  <div class="pb-5 px-4 lg:px-0 mt-12 sm:mt-24 sm:flex sm:items-center">
    <h1 class="text-lg leading-6 font-medium text-gray-900">
      <%= t(".ror_developers") %>
    </h1>

    <div class="mt-3 sm:mt-0 sm:ml-auto">
      <% if @query.available? %>
        <%= link_to "Show all developers", developers_path %>
      <% else %>
        <%= link_to "Show available developers", developers_path(available: true) %>
      <% end %>
    </div>
  </div>

  <div id="developers" class="space-y-8">
    <%= render DeveloperCardComponent.with_collection(@query.records) %>
  </div>

  <div class="mt-8">
    <%= pagy_links do %>
      <%== pagy_nav @query.pagy %>
    <% end %>
  </div>

  <%= turbo_frame_tag "developers-#{@query.pagy.page}" do %>
    <%= turbo_stream.append "developers" do %>
      <% unless @query.pagy.page == 1 %>
        <%= render DeveloperCardComponent.with_collection(@query.records) %>
      <% end %>
      <% if @query.pagy.next %>
        <%= turbo_frame_tag "developers-#{@query.pagy.page + 1}", src: [:developers, page: @query.pagy.next], loading: :lazy %>
      <% end %>
    <% end %>
  <% end %>
</div>
